# ==============================
# GLOBAL CONFIGURATION
# ==============================
train_stage: VAE           # Disentangle, VAE
img_size: 128
data_dir: ./data
batch_size: 32
epochs: 120
lr: 0.0001
checkpoint_interval: 25 #500
in_channels: 1
seed: 10086

# ==============================
# VAE CONFIGURATION
# ==============================
vae:
  # ---- Experiment & Saving ----
  train_stage: VAE           # Disentangle, VAE
  experiment_name: super_vae_16*16*4
  seed: 10086     
  batch_size: 32
  epochs: 120
  lr: 0.0001
  ckpt_to_cpu: true          
  train_log_interval: 200 
  val_interval: 8000  #5000

  # ---- Data ----
  train_data_root: /scratch/rw3239/Content-Style-Disentangled-Representation-Learning/lmdb_data
  val_data_root: /scratch/rw3239/Content-Style-Disentangled-Representation-Learning/lmdb_data
  img_size: 128
  in_channels: 1
  augment_prob: 0.5
  train_sample_count: 100000
  val_sample_count: 1000
  # checkpoint_interval: 25 #500
  resume_ckpt: "" 

  # ---- Model ----
  encoder: vae_encoder          
  decoder: vae_decoder          
  use_gan: true
  use_ema: true
  latent_dim: 256

  # ---- Loss Weights ----
  kl_weight: 0   #0.2
  vq_loss_weight: 1.0
  gan_weight: 0.2
  lecam_weight: 0.05
  lpips_weight: 0.8

  # ---- LR Scheduler ----
  lr_scheduler: linear-warmup_cosine-decay  # or linear-warmup, None
  warmup_epochs: 8 # 10
  min_lr: 0.00001

  # ---- KL Annealing ----
  kl_anneal:
    enabled: false
    start_epoch: 0
    end_epoch: 100

  # ---- Gradient ----
  gradient_clip_val: 1.0



# ==============================
# DISENTANGLE CONFIGURATION
# ==============================
disentangle:
  encoder_c: vae_encoder
  encoder_s: vae_encoder 
  decoder: vae_decoder
  latent_dim: 256
  use_gan: true
  lpips_weight: 0.8
  kl_weight: 0.2
  vq_loss_weight: 1.0
  gan_weight: 0.2
  resume_ckpt: ""  # optional resume
  vq_content: false
  vq_style: false
  vq_content_codebook_size: 512
  vq_style_codebook_size: 256
  img_size: 128
  data_root: ./data
  batch_size: 32
  epochs: 100
  lr: 0.0001
  checkpoint_interval: 25 #500
  in_channels: 1

# ==============================
# DDPM CONFIGURATION
# ==============================
ddpm:
  freeze_ckpt: checkpoints/resnet34/ckpt_epoch_99.pth