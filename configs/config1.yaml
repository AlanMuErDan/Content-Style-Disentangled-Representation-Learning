# ==============================
# GLOBAL CONFIGURATION
# ==============================
train_stage: VAE           # Disentangle, VAE
img_size: 128
data_dir: ./data
batch_size: 32
epochs: 5000
lr: 0.0001
checkpoint_interval: 500
in_channels: 1
seed: 10086

# ==============================
# VAE CONFIGURATION
# ==============================
vae:
  encoder: vae_encoder          
  decoder: vae_decoder          
  use_gan: true
  use_ema: true
  latent_dim: 256              
  lpips_weight: 0.8
  kl_weight: 0   #0.2
  vq_loss_weight: 0.0
  gan_weight: 0.2
  train_stage: VAE           # Disentangle, VAE
  img_size: 128
  train_data_root: ./data/train
  val_data_root: ./data/val
  batch_size: 32
  epochs: 5000
  lr: 0.0001
  checkpoint_interval: 500
  resume_ckpt: "" 
  in_channels: 1
  val_interval: 5000
  train_log_interval: 100

  # LR scheduler
  lr_scheduler: linear-warmup_cosine-decay  # or linear-warmup, None
  warmup_epochs: 10
  min_lr: 0.00001

  # KL annealing
  kl_anneal:
    enabled: false
    start_epoch: 0
    end_epoch: 100

  # Gradient clipping
  gradient_clip_val: 1.0

  # GAN
  lecam_weight: 0.05

# ==============================
# DISENTANGLE CONFIGURATION
# ==============================
disentangle:
  encoder_c: vae_encoder
  encoder_s: vae_encoder 
  decoder: vae_decoder
  latent_dim: 256
  use_gan: true
  lpips_weight: 0.8
  kl_weight: 0.2
  vq_loss_weight: 1.0
  gan_weight: 0.2
  resume_ckpt: ""  # optional resume
  vq_content: false
  vq_style: false
  vq_content_codebook_size: 512
  vq_style_codebook_size: 256
  img_size: 128
  data_root: ./data
  batch_size: 32
  epochs: 5000
  lr: 0.0001
  checkpoint_interval: 500
  in_channels: 1

# ==============================
# DDPM CONFIGURATION
# ==============================
ddpm:
  freeze_ckpt: checkpoints/resnet34/ckpt_epoch_99.pth