Disentangle VAE Training...
Training config: {'encoder': 'vae_encoder', 'decoder': 'vae_decoder', 'use_gan': True, 'use_ema': True, 'latent_dim': 256, 'lpips_weight': 0.8, 'kl_weight': 0.2, 'vq_loss_weight': 1.0, 'gan_weight': 0.5, 'train_stage': 'VAE', 'img_size': 128, 'train_data_root': './data/train', 'val_data_root': './data/val', 'batch_size': 32, 'epochs': 5000, 'lr': 0.0001, 'checkpoint_interval': 500, 'resume_ckpt': '', 'in_channels': 1, 'val_interval': 5000, 'train_log_interval': 100, 'lr_scheduler': 'linear-warmup_cosine-decay', 'warmup_epochs': 10, 'min_lr': 1e-05, 'kl_anneal': {'enabled': True, 'start_epoch': 0, 'end_epoch': 100}, 'gradient_clip_val': 1.0, 'lecam_weight': 0.1}
Using device: cuda
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /scratch/gz2199/calli_env/lib/python3.9/site-packages/lpips/weights/v0.1/vgg.pth
Using GAN: True, EMA: True
No checkpoint found or resume_ckpt not specified.
Found 79999 images in dataset.
[Epoch 0] Avg Loss: 0.7119
[Validation] L2: 0.0870, LPIPS: 0.1414
[Epoch 1] Avg Loss: 0.3558
[Epoch 2] Avg Loss: 0.2273
[Validation] L2: 0.0556, LPIPS: 0.0919
[Epoch 3] Avg Loss: 0.1896
[Epoch 4] Avg Loss: 0.1111
[Validation] L2: 0.0364, LPIPS: 0.0559
[Epoch 5] Avg Loss: 0.0781
[Epoch 6] Avg Loss: 0.0774
[Validation] L2: 0.0326, LPIPS: 0.0441
[Epoch 7] Avg Loss: 0.0989
[Epoch 8] Avg Loss: 0.1124
[Validation] L2: 0.0275, LPIPS: 0.0378
[Epoch 9] Avg Loss: 0.1223
[Epoch 10] Avg Loss: 0.0980
[Validation] L2: 0.0255, LPIPS: 0.0342
[Epoch 11] Avg Loss: 0.0971
[Epoch 12] Avg Loss: 0.0762
[Validation] L2: 0.0261, LPIPS: 0.0359
[Epoch 13] Avg Loss: 0.0922
[Epoch 14] Avg Loss: 0.0593
[Validation] L2: 0.0259, LPIPS: 0.0336
[Epoch 15] Avg Loss: 0.0773
[Epoch 16] Avg Loss: 0.0544
[Validation] L2: 0.0255, LPIPS: 0.0341
[Epoch 17] Avg Loss: 0.0759
[Epoch 18] Avg Loss: 0.1195
[Validation] L2: 0.0242, LPIPS: 0.0320
[Epoch 19] Avg Loss: 0.0993
[Epoch 20] Avg Loss: 0.0828
[Validation] L2: 0.0271, LPIPS: 0.0354
[Epoch 21] Avg Loss: 0.0767
[Epoch 22] Avg Loss: 0.0681
[Validation] L2: 0.0269, LPIPS: 0.0351
[Epoch 23] Avg Loss: 0.0881
[Epoch 24] Avg Loss: 0.0949
[Validation] L2: 0.0286, LPIPS: 0.0382
[Epoch 25] Avg Loss: 0.0955
[Epoch 26] Avg Loss: 0.1019
[Validation] L2: 0.0289, LPIPS: 0.0379
[Epoch 27] Avg Loss: 0.0892
[Epoch 28] Avg Loss: 0.0963
[Validation] L2: 0.0316, LPIPS: 0.0417
[Epoch 29] Avg Loss: 0.1160
[Epoch 30] Avg Loss: 0.1057
[Validation] L2: 0.0304, LPIPS: 0.0414
[Epoch 31] Avg Loss: 0.1088
[Epoch 32] Avg Loss: 0.1115
[Validation] L2: 0.0353, LPIPS: 0.0438
[Epoch 33] Avg Loss: 0.0972
[Epoch 34] Avg Loss: 0.1128
[Validation] L2: 0.0349, LPIPS: 0.0456
[Epoch 35] Avg Loss: 0.1230
[Epoch 36] Avg Loss: 0.1187
[Validation] L2: 0.0358, LPIPS: 0.0481
[Epoch 37] Avg Loss: 0.1323
[Epoch 38] Avg Loss: 0.1306
[Validation] L2: 0.0351, LPIPS: 0.0507
[Epoch 39] Avg Loss: 0.1320
[Epoch 40] Avg Loss: 0.1248
[Validation] L2: 0.0371, LPIPS: 0.0489
[Epoch 41] Avg Loss: 0.1314
[Epoch 42] Avg Loss: 0.1322
[Validation] L2: 0.0351, LPIPS: 0.0481
[Epoch 43] Avg Loss: 0.1389
[Epoch 44] Avg Loss: 0.1345
[Validation] L2: 0.0361, LPIPS: 0.0493
[Epoch 45] Avg Loss: 0.1489
[Epoch 46] Avg Loss: 0.1370
[Validation] L2: 0.0411, LPIPS: 0.0560
[Epoch 47] Avg Loss: 0.1506
[Epoch 48] Avg Loss: 0.1412
[Validation] L2: 0.0383, LPIPS: 0.0566
[Epoch 49] Avg Loss: 0.1535
[Epoch 50] Avg Loss: 0.1616
[Validation] L2: 0.0405, LPIPS: 0.0563
[Epoch 51] Avg Loss: 0.1507
[Epoch 52] Avg Loss: 0.1552
[Validation] L2: 0.0374, LPIPS: 0.0511
[Epoch 53] Avg Loss: 0.1628
[Epoch 54] Avg Loss: 0.1626
[Validation] L2: 0.0420, LPIPS: 0.0566
[Epoch 55] Avg Loss: 0.1642
[Epoch 56] Avg Loss: 0.1657
[Validation] L2: 0.0403, LPIPS: 0.0575
[Epoch 57] Avg Loss: 0.1680
[Epoch 58] Avg Loss: 0.1699
[Validation] L2: 0.0425, LPIPS: 0.0573
[Epoch 59] Avg Loss: 0.1766
[Epoch 60] Avg Loss: 0.1720
[Validation] L2: 0.0409, LPIPS: 0.0559
[Epoch 61] Avg Loss: 0.1737
[Epoch 62] Avg Loss: 0.1830
[Validation] L2: 0.0427, LPIPS: 0.0587
[Epoch 63] Avg Loss: 0.1819
[Epoch 64] Avg Loss: 0.1862
[Validation] L2: 0.0497, LPIPS: 0.0668
[Epoch 65] Avg Loss: 0.1834
[Epoch 66] Avg Loss: 0.1936
[Validation] L2: 0.0427, LPIPS: 0.0660
[Epoch 67] Avg Loss: 0.1943
[Epoch 68] Avg Loss: 0.2018
[Validation] L2: 0.0588, LPIPS: 0.0791
[Epoch 69] Avg Loss: 0.1973
[Epoch 70] Avg Loss: 0.2106
[Validation] L2: 0.0458, LPIPS: 0.0683
[Epoch 71] Avg Loss: 0.2022
[Epoch 72] Avg Loss: 0.2098
[Validation] L2: 0.0439, LPIPS: 0.0637
[Epoch 73] Avg Loss: 0.2174
[Epoch 74] Avg Loss: 0.2166
[Validation] L2: 0.0506, LPIPS: 0.0677
[Epoch 75] Avg Loss: 0.2176
[Epoch 76] Avg Loss: 0.2216
[Validation] L2: 0.0464, LPIPS: 0.0677
[Epoch 77] Avg Loss: 0.2119
[Epoch 78] Avg Loss: 0.2164
[Validation] L2: 0.0498, LPIPS: 0.0666
[Epoch 79] Avg Loss: 0.2383
[Epoch 80] Avg Loss: 0.2348
[Validation] L2: 0.0485, LPIPS: 0.0707
[Epoch 81] Avg Loss: 0.2348
[Epoch 82] Avg Loss: 0.2324
[Validation] L2: 0.0512, LPIPS: 0.0703
[Epoch 83] Avg Loss: 0.2350
[Epoch 84] Avg Loss: 0.2365
[Validation] L2: 0.0537, LPIPS: 0.0723
[Epoch 85] Avg Loss: 0.2479
[Epoch 86] Avg Loss: 0.2542
[Validation] L2: 0.0498, LPIPS: 0.0703
[Epoch 87] Avg Loss: 0.2602
[Epoch 88] Avg Loss: 0.2614
[Validation] L2: 0.0496, LPIPS: 0.0716
[Epoch 89] Avg Loss: 0.2558
[Epoch 90] Avg Loss: 0.2580
[Validation] L2: 0.0518, LPIPS: 0.0779
[Epoch 91] Avg Loss: 0.2593
[Epoch 92] Avg Loss: 0.2663
[Validation] L2: 0.0612, LPIPS: 0.0804
[Epoch 93] Avg Loss: 0.2777
[Epoch 94] Avg Loss: 0.2883
[Validation] L2: 0.0522, LPIPS: 0.0753
[Epoch 95] Avg Loss: 0.2861
[Epoch 96] Avg Loss: 0.2835
[Validation] L2: 0.0539, LPIPS: 0.0771
[Epoch 97] Avg Loss: 0.2955
[Epoch 98] Avg Loss: 0.2877
[Validation] L2: 0.0599, LPIPS: 0.0837
[Epoch 99] Avg Loss: 0.2978
[Epoch 100] Avg Loss: 0.2973
[Validation] L2: 0.0497, LPIPS: 0.0746
[Epoch 101] Avg Loss: 0.2955
