Disentangle VAE Training...
Training config: {'encoder': 'vae_encoder', 'decoder': 'vae_decoder', 'use_gan': True, 'use_ema': True, 'latent_dim': 256, 'lpips_weight': 0.8, 'kl_weight': 0, 'vq_loss_weight': 1.0, 'gan_weight': 0.2, 'train_stage': 'VAE', 'img_size': 128, 'train_data_root': './data/train', 'val_data_root': './data/val', 'batch_size': 32, 'epochs': 5000, 'lr': 0.0001, 'checkpoint_interval': 500, 'resume_ckpt': '', 'in_channels': 1, 'val_interval': 5000, 'train_log_interval': 100, 'lr_scheduler': 'linear-warmup_cosine-decay', 'warmup_epochs': 10, 'min_lr': 1e-05, 'kl_anneal': {'enabled': False, 'start_epoch': 0, 'end_epoch': 100}, 'gradient_clip_val': 1.0, 'lecam_weight': 0.05}
Using device: cuda
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /scratch/gz2199/calli_env/lib/python3.9/site-packages/lpips/weights/v0.1/vgg.pth
Using GAN: True, EMA: True
ðŸ‘‰Decoder expected img_size: 128
No checkpoint found or resume_ckpt not specified.
Found 79999 images in dataset.
[Epoch 0] Avg Loss: 0.4922
[Validation] L2: 0.0355, LPIPS: 0.0653
[Epoch 1] Avg Loss: 0.0888
[Epoch 2] Avg Loss: 0.0422
[Validation] L2: 0.0162, LPIPS: 0.0248
[Epoch 3] Avg Loss: 0.0296
[Epoch 4] Avg Loss: 0.0223
[Validation] L2: 0.0099, LPIPS: 0.0123
[Epoch 5] Avg Loss: 0.0208
[Epoch 6] Avg Loss: 0.0166
[Validation] L2: 0.0073, LPIPS: 0.0076
[Epoch 7] Avg Loss: 0.0090
[Epoch 8] Avg Loss: 0.0371
[Validation] L2: 0.0059, LPIPS: 0.0054
[Epoch 9] Avg Loss: 0.0301
[Epoch 10] Avg Loss: 0.0116
[Validation] L2: 0.0051, LPIPS: 0.0042
[Epoch 11] Avg Loss: 0.0087
[Epoch 12] Avg Loss: 0.0162
[Validation] L2: 0.0047, LPIPS: 0.0037
[Epoch 13] Avg Loss: 0.0157
[Epoch 14] Avg Loss: 0.0109
[Validation] L2: 0.0045, LPIPS: 0.0034
[Epoch 15] Avg Loss: 0.0225
[Epoch 16] Avg Loss: 0.0082
[Validation] L2: 0.0043, LPIPS: 0.0031
[Epoch 17] Avg Loss: 0.0066
[Epoch 18] Avg Loss: 0.0118
[Validation] L2: 0.0042, LPIPS: 0.0030
[Epoch 19] Avg Loss: 0.0107
[Epoch 20] Avg Loss: 0.0110
[Validation] L2: 0.0041, LPIPS: 0.0029
[Epoch 21] Avg Loss: 0.0114
[Epoch 22] Avg Loss: 0.0125
[Validation] L2: 0.0040, LPIPS: 0.0027
[Epoch 23] Avg Loss: 0.0067
[Epoch 24] Avg Loss: 0.0008
[Validation] L2: 0.0039, LPIPS: 0.0027
[Epoch 25] Avg Loss: 0.0041
[Epoch 26] Avg Loss: 0.0038
[Validation] L2: 0.0039, LPIPS: 0.0026
[Epoch 27] Avg Loss: -0.0025
[Epoch 28] Avg Loss: 0.0009
[Validation] L2: 0.0038, LPIPS: 0.0026
[Epoch 29] Avg Loss: 0.0059
[Epoch 30] Avg Loss: -0.0024
[Validation] L2: 0.0038, LPIPS: 0.0025
[Epoch 31] Avg Loss: -0.0033
[Epoch 32] Avg Loss: 0.0100
[Validation] L2: 0.0037, LPIPS: 0.0024
[Epoch 33] Avg Loss: 0.0046
[Epoch 34] Avg Loss: 0.0069
[Validation] L2: 0.0037, LPIPS: 0.0024
[Epoch 35] Avg Loss: 0.0028
[Epoch 36] Avg Loss: 0.0006
[Validation] L2: 0.0037, LPIPS: 0.0024
[Epoch 37] Avg Loss: 0.0038
[Epoch 38] Avg Loss: 0.0015
[Validation] L2: 0.0036, LPIPS: 0.0024
[Epoch 39] Avg Loss: -0.0003
[Epoch 40] Avg Loss: -0.0018
[Validation] L2: 0.0036, LPIPS: 0.0024
[Epoch 41] Avg Loss: 0.0042
[Epoch 42] Avg Loss: 0.0123
[Validation] L2: 0.0036, LPIPS: 0.0024
[Epoch 43] Avg Loss: 0.0098
[Epoch 44] Avg Loss: 0.0204
[Validation] L2: 0.0037, LPIPS: 0.0024
[Epoch 45] Avg Loss: 0.0141
[Epoch 46] Avg Loss: 0.0143
[Validation] L2: 0.0037, LPIPS: 0.0024
[Epoch 47] Avg Loss: 0.0046
[Epoch 48] Avg Loss: 0.0156
[Validation] L2: 0.0037, LPIPS: 0.0024
[Epoch 49] Avg Loss: 0.0207
[Epoch 50] Avg Loss: 0.0168
[Validation] L2: 0.0038, LPIPS: 0.0025
[Epoch 51] Avg Loss: 0.0151
[Epoch 52] Avg Loss: 0.0174
[Validation] L2: 0.0038, LPIPS: 0.0025
[Epoch 53] Avg Loss: 0.0141
[Epoch 54] Avg Loss: 0.0067
[Validation] L2: 0.0038, LPIPS: 0.0026
[Epoch 55] Avg Loss: 0.0091
[Epoch 56] Avg Loss: 0.0199
[Validation] L2: 0.0039, LPIPS: 0.0027
[Epoch 57] Avg Loss: 0.0063
[Epoch 58] Avg Loss: 0.0159
[Validation] L2: 0.0039, LPIPS: 0.0027
[Epoch 59] Avg Loss: 0.0102
[Epoch 60] Avg Loss: 0.0145
[Validation] L2: 0.0040, LPIPS: 0.0028
[Epoch 61] Avg Loss: 0.0127
[Epoch 62] Avg Loss: 0.0128
[Validation] L2: 0.0040, LPIPS: 0.0028
[Epoch 63] Avg Loss: 0.0063
[Epoch 64] Avg Loss: 0.0094
[Validation] L2: 0.0041, LPIPS: 0.0030
[Epoch 65] Avg Loss: 0.0131
[Epoch 66] Avg Loss: 0.0113
[Validation] L2: 0.0041, LPIPS: 0.0029
[Epoch 67] Avg Loss: 0.0207
[Epoch 68] Avg Loss: 0.0094
[Validation] L2: 0.0043, LPIPS: 0.0032
[Epoch 69] Avg Loss: 0.0144
[Epoch 70] Avg Loss: 0.0144
[Validation] L2: 0.0043, LPIPS: 0.0031
[Epoch 71] Avg Loss: 0.0131
[Epoch 72] Avg Loss: 0.0162
[Validation] L2: 0.0044, LPIPS: 0.0032
[Epoch 73] Avg Loss: 0.0074
[Epoch 74] Avg Loss: 0.0129
[Validation] L2: 0.0044, LPIPS: 0.0033
[Epoch 75] Avg Loss: 0.0111
[Epoch 76] Avg Loss: 0.0121
[Validation] L2: 0.0045, LPIPS: 0.0033
[Epoch 77] Avg Loss: 0.0124
[Epoch 78] Avg Loss: 0.0139
[Validation] L2: 0.0046, LPIPS: 0.0034
[Epoch 79] Avg Loss: 0.0113
[Epoch 80] Avg Loss: 0.0110
[Validation] L2: 0.0046, LPIPS: 0.0035
[Epoch 81] Avg Loss: 0.0146
[Epoch 82] Avg Loss: 0.0225
[Validation] L2: 0.0048, LPIPS: 0.0036
[Epoch 83] Avg Loss: 0.0193
[Epoch 84] Avg Loss: 0.0164
[Validation] L2: 0.0048, LPIPS: 0.0037
[Epoch 85] Avg Loss: 0.0143
[Epoch 86] Avg Loss: 0.0148
[Validation] L2: 0.0048, LPIPS: 0.0037
[Epoch 87] Avg Loss: 0.0222
[Epoch 88] Avg Loss: 0.0202
