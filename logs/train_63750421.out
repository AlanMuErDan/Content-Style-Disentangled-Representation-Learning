Disentangle VAE Training...
Training config: {'encoder': 'vae_encoder', 'decoder': 'vae_decoder', 'use_gan': True, 'use_ema': True, 'latent_dim': 256, 'lpips_weight': 0.8, 'kl_weight': 0.2, 'vq_loss_weight': 1.0, 'gan_weight': 0.2, 'train_stage': 'VAE', 'img_size': 128, 'train_data_root': './data/train', 'val_data_root': './data/val', 'batch_size': 32, 'epochs': 5000, 'lr': 0.0001, 'checkpoint_interval': 500, 'resume_ckpt': '', 'in_channels': 1, 'val_interval': 5000, 'train_log_interval': 100, 'lr_scheduler': 'linear-warmup_cosine-decay', 'warmup_epochs': 10, 'min_lr': 1e-05, 'kl_anneal': {'enabled': True, 'start_epoch': 0, 'end_epoch': 100}, 'gradient_clip_val': 1.0, 'lecam_weight': 0.1}
Using device: cuda
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /scratch/gz2199/calli_env/lib/python3.9/site-packages/lpips/weights/v0.1/vgg.pth
Using GAN: True, EMA: True
No checkpoint found or resume_ckpt not specified.
Found 79999 images in dataset.
[Epoch 0] Avg Loss: 0.5878
[Validation] L2: 0.0748, LPIPS: 0.1266
[Epoch 1] Avg Loss: 0.2652
[Epoch 2] Avg Loss: 0.1980
[Validation] L2: 0.0446, LPIPS: 0.0759
[Epoch 3] Avg Loss: 0.1388
[Epoch 4] Avg Loss: 0.1050
[Validation] L2: 0.0343, LPIPS: 0.0494
[Epoch 5] Avg Loss: 0.0800
[Epoch 6] Avg Loss: 0.0816
[Validation] L2: 0.0307, LPIPS: 0.0420
[Epoch 7] Avg Loss: 0.0808
[Epoch 8] Avg Loss: 0.0755
[Validation] L2: 0.0270, LPIPS: 0.0369
[Epoch 9] Avg Loss: 0.0776
[Epoch 10] Avg Loss: 0.0743
[Validation] L2: 0.0260, LPIPS: 0.0349
[Epoch 11] Avg Loss: 0.0795
[Epoch 12] Avg Loss: 0.0735
[Validation] L2: 0.0268, LPIPS: 0.0352
[Epoch 13] Avg Loss: 0.0768
[Epoch 14] Avg Loss: 0.0796
[Validation] L2: 0.0283, LPIPS: 0.0367
[Epoch 15] Avg Loss: 0.0809
[Epoch 16] Avg Loss: 0.0840
[Validation] L2: 0.0294, LPIPS: 0.0362
[Epoch 17] Avg Loss: 0.0853
[Epoch 18] Avg Loss: 0.0830
[Validation] L2: 0.0274, LPIPS: 0.0369
[Epoch 19] Avg Loss: 0.0865
[Epoch 20] Avg Loss: 0.0884
[Validation] L2: 0.0305, LPIPS: 0.0384
[Epoch 21] Avg Loss: 0.0925
[Epoch 22] Avg Loss: 0.0860
[Validation] L2: 0.0317, LPIPS: 0.0419
[Epoch 23] Avg Loss: 0.0927
[Epoch 24] Avg Loss: 0.0953
[Validation] L2: 0.0305, LPIPS: 0.0429
[Epoch 25] Avg Loss: 0.0981
[Epoch 26] Avg Loss: 0.1010
[Validation] L2: 0.0318, LPIPS: 0.0440
[Epoch 27] Avg Loss: 0.0947
[Epoch 28] Avg Loss: 0.1087
[Validation] L2: 0.0318, LPIPS: 0.0434
[Epoch 29] Avg Loss: 0.1050
[Epoch 30] Avg Loss: 0.1006
[Validation] L2: 0.0331, LPIPS: 0.0435
[Epoch 31] Avg Loss: 0.1063
[Epoch 32] Avg Loss: 0.1077
[Validation] L2: 0.0360, LPIPS: 0.0494
[Epoch 33] Avg Loss: 0.1145
[Epoch 34] Avg Loss: 0.1138
[Validation] L2: 0.0345, LPIPS: 0.0458
[Epoch 35] Avg Loss: 0.1172
[Epoch 36] Avg Loss: 0.1171
[Validation] L2: 0.0352, LPIPS: 0.0496
[Epoch 37] Avg Loss: 0.1182
[Epoch 38] Avg Loss: 0.1218
[Validation] L2: 0.0377, LPIPS: 0.0530
[Epoch 39] Avg Loss: 0.1250
[Epoch 40] Avg Loss: 0.1304
[Validation] L2: 0.0364, LPIPS: 0.0465
[Epoch 41] Avg Loss: 0.1295
[Epoch 42] Avg Loss: 0.1324
[Validation] L2: 0.0375, LPIPS: 0.0505
[Epoch 43] Avg Loss: 0.1309
[Epoch 44] Avg Loss: 0.1350
[Validation] L2: 0.0370, LPIPS: 0.0526
[Epoch 45] Avg Loss: 0.1367
[Epoch 46] Avg Loss: 0.1342
[Validation] L2: 0.0365, LPIPS: 0.0504
[Epoch 47] Avg Loss: 0.1392
[Epoch 48] Avg Loss: 0.1441
[Validation] L2: 0.0395, LPIPS: 0.0552
[Epoch 49] Avg Loss: 0.1448
[Epoch 50] Avg Loss: 0.1461
[Validation] L2: 0.0393, LPIPS: 0.0560
[Epoch 51] Avg Loss: 0.1459
[Epoch 52] Avg Loss: 0.1483
[Validation] L2: 0.0383, LPIPS: 0.0554
[Epoch 53] Avg Loss: 0.1540
[Epoch 54] Avg Loss: 0.1546
[Validation] L2: 0.0409, LPIPS: 0.0551
[Epoch 55] Avg Loss: 0.1565
[Epoch 56] Avg Loss: 0.1568
[Validation] L2: 0.0423, LPIPS: 0.0561
[Epoch 57] Avg Loss: 0.1579
[Epoch 58] Avg Loss: 0.1594
[Validation] L2: 0.0404, LPIPS: 0.0543
[Epoch 59] Avg Loss: 0.1634
[Epoch 60] Avg Loss: 0.1626
[Validation] L2: 0.0408, LPIPS: 0.0548
[Epoch 61] Avg Loss: 0.1668
[Epoch 62] Avg Loss: 0.1687
[Validation] L2: 0.0411, LPIPS: 0.0560
[Epoch 63] Avg Loss: 0.1708
[Epoch 64] Avg Loss: 0.1762
[Validation] L2: 0.0460, LPIPS: 0.0623
[Epoch 65] Avg Loss: 0.1778
[Epoch 66] Avg Loss: 0.1799
[Validation] L2: 0.0465, LPIPS: 0.0648
[Epoch 67] Avg Loss: 0.1839
[Epoch 68] Avg Loss: 0.1850
[Validation] L2: 0.0417, LPIPS: 0.0594
[Epoch 69] Avg Loss: 0.1906
[Epoch 70] Avg Loss: 0.1895
[Validation] L2: 0.0470, LPIPS: 0.0662
[Epoch 71] Avg Loss: 0.1923
[Epoch 72] Avg Loss: 0.1940
[Validation] L2: 0.0443, LPIPS: 0.0611
[Epoch 73] Avg Loss: 0.1964
[Epoch 74] Avg Loss: 0.1991
[Validation] L2: 0.0459, LPIPS: 0.0691
[Epoch 75] Avg Loss: 0.2023
[Epoch 76] Avg Loss: 0.2018
[Validation] L2: 0.0435, LPIPS: 0.0625
[Epoch 77] Avg Loss: 0.2017
[Epoch 78] Avg Loss: 0.2064
[Validation] L2: 0.0492, LPIPS: 0.0749
[Epoch 79] Avg Loss: 0.2094
[Epoch 80] Avg Loss: 0.2146
[Validation] L2: 0.0445, LPIPS: 0.0652
[Epoch 81] Avg Loss: 0.2123
[Epoch 82] Avg Loss: 0.2142
[Validation] L2: 0.0434, LPIPS: 0.0635
[Epoch 83] Avg Loss: 0.2163
[Epoch 84] Avg Loss: 0.2190
[Validation] L2: 0.0499, LPIPS: 0.0693
[Epoch 85] Avg Loss: 0.2230
[Epoch 86] Avg Loss: 0.2238
[Validation] L2: 0.0480, LPIPS: 0.0690
[Epoch 87] Avg Loss: 0.2264
[Epoch 88] Avg Loss: 0.2293
[Validation] L2: 0.0481, LPIPS: 0.0707
[Epoch 89] Avg Loss: 0.2319
[Epoch 90] Avg Loss: 0.2333
[Validation] L2: 0.0447, LPIPS: 0.0655
[Epoch 91] Avg Loss: 0.2361
[Epoch 92] Avg Loss: 0.2386
[Validation] L2: 0.0472, LPIPS: 0.0696
[Epoch 93] Avg Loss: 0.2388
[Epoch 94] Avg Loss: 0.2421
[Validation] L2: 0.0475, LPIPS: 0.0673
[Epoch 95] Avg Loss: 0.2432
[Epoch 96] Avg Loss: 0.2475
[Validation] L2: 0.0498, LPIPS: 0.0718
[Epoch 97] Avg Loss: 0.2484
[Epoch 98] Avg Loss: 0.2509
[Validation] L2: 0.0558, LPIPS: 0.0819
[Epoch 99] Avg Loss: 0.2532
[Epoch 100] Avg Loss: 0.2549
[Validation] L2: 0.0529, LPIPS: 0.0732
[Epoch 101] Avg Loss: 0.2580
