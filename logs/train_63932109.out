Disentangle VAE Training...
Training config: {'encoder': 'vae_encoder', 'decoder': 'vae_decoder', 'use_gan': True, 'use_ema': True, 'latent_dim': 256, 'lpips_weight': 0.8, 'kl_weight': 0.2, 'vq_loss_weight': 1.0, 'gan_weight': 0.2, 'train_stage': 'VAE', 'img_size': 128, 'train_data_root': './data/train', 'val_data_root': './data/val', 'batch_size': 32, 'epochs': 5000, 'lr': 0.0001, 'checkpoint_interval': 500, 'resume_ckpt': '', 'in_channels': 1, 'val_interval': 5000, 'train_log_interval': 100, 'lr_scheduler': 'linear-warmup_cosine-decay', 'warmup_epochs': 10, 'min_lr': 1e-05, 'kl_anneal': {'enabled': True, 'start_epoch': 0, 'end_epoch': 100}, 'gradient_clip_val': 1.0, 'lecam_weight': 0.1}
Using device: cuda
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /scratch/gz2199/calli_env/lib/python3.9/site-packages/lpips/weights/v0.1/vgg.pth
Using GAN: True, EMA: True
ðŸ‘‰Decoder expected img_size: 128
No checkpoint found or resume_ckpt not specified.
Found 79999 images in dataset.
[Epoch 0] Avg Loss: 0.4939
[Validation] L2: 0.0351, LPIPS: 0.0646
[Epoch 1] Avg Loss: 0.1014
[Epoch 2] Avg Loss: 0.0423
[Validation] L2: 0.0175, LPIPS: 0.0268
[Epoch 3] Avg Loss: 0.0585
[Epoch 4] Avg Loss: 0.0336
[Validation] L2: 0.0126, LPIPS: 0.0159
[Epoch 5] Avg Loss: 0.0330
[Epoch 6] Avg Loss: 0.0343
[Validation] L2: 0.0104, LPIPS: 0.0113
[Epoch 7] Avg Loss: 0.0409
[Epoch 8] Avg Loss: 0.0516
[Validation] L2: 0.0093, LPIPS: 0.0092
[Epoch 9] Avg Loss: 0.0517
[Epoch 10] Avg Loss: 0.0454
[Validation] L2: 0.0087, LPIPS: 0.0083
[Epoch 11] Avg Loss: 0.0303
[Epoch 12] Avg Loss: 0.0184
[Validation] L2: 0.0085, LPIPS: 0.0080
[Epoch 13] Avg Loss: 0.0045
[Epoch 14] Avg Loss: 0.0160
[Validation] L2: 0.0085, LPIPS: 0.0080
[Epoch 15] Avg Loss: 0.0281
[Epoch 16] Avg Loss: 0.0130
[Validation] L2: 0.0086, LPIPS: 0.0080
[Epoch 17] Avg Loss: 0.0176
[Epoch 18] Avg Loss: 0.0385
[Validation] L2: 0.0088, LPIPS: 0.0083
[Epoch 19] Avg Loss: 0.0198
[Epoch 20] Avg Loss: 0.0326
[Validation] L2: 0.0090, LPIPS: 0.0086
[Epoch 21] Avg Loss: 0.0291
[Epoch 22] Avg Loss: 0.0379
[Validation] L2: 0.0092, LPIPS: 0.0088
[Epoch 23] Avg Loss: 0.0338
[Epoch 24] Avg Loss: 0.0474
[Validation] L2: 0.0094, LPIPS: 0.0090
[Epoch 25] Avg Loss: 0.0308
[Epoch 26] Avg Loss: 0.0355
[Validation] L2: 0.0097, LPIPS: 0.0094
[Epoch 27] Avg Loss: 0.0433
[Epoch 28] Avg Loss: 0.0362
[Validation] L2: 0.0099, LPIPS: 0.0097
[Epoch 29] Avg Loss: 0.0332
[Epoch 30] Avg Loss: 0.0470
[Validation] L2: 0.0101, LPIPS: 0.0101
[Epoch 31] Avg Loss: 0.0488
[Epoch 32] Avg Loss: 0.0477
[Validation] L2: 0.0103, LPIPS: 0.0103
[Epoch 33] Avg Loss: 0.0394
[Epoch 34] Avg Loss: 0.0448
[Validation] L2: 0.0105, LPIPS: 0.0107
[Epoch 35] Avg Loss: 0.0483
[Epoch 36] Avg Loss: 0.0511
[Validation] L2: 0.0108, LPIPS: 0.0111
[Epoch 37] Avg Loss: 0.0587
[Epoch 38] Avg Loss: 0.0623
[Validation] L2: 0.0110, LPIPS: 0.0114
[Epoch 39] Avg Loss: 0.0556
[Epoch 40] Avg Loss: 0.0610
[Validation] L2: 0.0112, LPIPS: 0.0118
[Epoch 41] Avg Loss: 0.0542
[Epoch 42] Avg Loss: 0.0629
[Validation] L2: 0.0113, LPIPS: 0.0120
[Epoch 43] Avg Loss: 0.0600
[Epoch 44] Avg Loss: 0.0510
[Validation] L2: 0.0117, LPIPS: 0.0125
[Epoch 45] Avg Loss: 0.0515
[Epoch 46] Avg Loss: 0.0604
[Validation] L2: 0.0118, LPIPS: 0.0127
[Epoch 47] Avg Loss: 0.0564
[Epoch 48] Avg Loss: 0.0551
[Validation] L2: 0.0121, LPIPS: 0.0131
[Epoch 49] Avg Loss: 0.0589
[Epoch 50] Avg Loss: 0.0563
[Validation] L2: 0.0123, LPIPS: 0.0136
[Epoch 51] Avg Loss: 0.0562
[Epoch 52] Avg Loss: 0.0623
[Validation] L2: 0.0125, LPIPS: 0.0138
[Epoch 53] Avg Loss: 0.0616
[Epoch 54] Avg Loss: 0.0483
[Validation] L2: 0.0127, LPIPS: 0.0141
[Epoch 55] Avg Loss: 0.0595
[Epoch 56] Avg Loss: 0.0630
[Validation] L2: 0.0129, LPIPS: 0.0144
[Epoch 57] Avg Loss: 0.0639
[Epoch 58] Avg Loss: 0.0646
[Validation] L2: 0.0131, LPIPS: 0.0148
[Epoch 59] Avg Loss: 0.0685
[Epoch 60] Avg Loss: 0.0683
[Validation] L2: 0.0132, LPIPS: 0.0149
[Epoch 61] Avg Loss: 0.0679
[Epoch 62] Avg Loss: 0.0653
[Validation] L2: 0.0134, LPIPS: 0.0154
[Epoch 63] Avg Loss: 0.0645
[Epoch 64] Avg Loss: 0.0728
[Validation] L2: 0.0136, LPIPS: 0.0156
[Epoch 65] Avg Loss: 0.0711
[Epoch 66] Avg Loss: 0.0655
[Validation] L2: 0.0138, LPIPS: 0.0161
[Epoch 67] Avg Loss: 0.0750
[Epoch 68] Avg Loss: 0.0724
[Validation] L2: 0.0141, LPIPS: 0.0164
[Epoch 69] Avg Loss: 0.0707
[Epoch 70] Avg Loss: 0.0744
[Validation] L2: 0.0141, LPIPS: 0.0165
[Epoch 71] Avg Loss: 0.0766
[Epoch 72] Avg Loss: 0.0766
[Validation] L2: 0.0143, LPIPS: 0.0169
[Epoch 73] Avg Loss: 0.0784
[Epoch 74] Avg Loss: 0.0828
[Validation] L2: 0.0145, LPIPS: 0.0171
[Epoch 75] Avg Loss: 0.0825
[Epoch 76] Avg Loss: 0.0840
[Validation] L2: 0.0147, LPIPS: 0.0174
[Epoch 77] Avg Loss: 0.0854
[Epoch 78] Avg Loss: 0.0837
[Validation] L2: 0.0150, LPIPS: 0.0180
[Epoch 79] Avg Loss: 0.0853
[Epoch 80] Avg Loss: 0.0908
[Validation] L2: 0.0150, LPIPS: 0.0180
[Epoch 81] Avg Loss: 0.0855
[Epoch 82] Avg Loss: 0.0841
[Validation] L2: 0.0153, LPIPS: 0.0186
[Epoch 83] Avg Loss: 0.0921
[Epoch 84] Avg Loss: 0.0908
[Validation] L2: 0.0154, LPIPS: 0.0189
[Epoch 85] Avg Loss: 0.0925
[Epoch 86] Avg Loss: 0.0929
[Validation] L2: 0.0156, LPIPS: 0.0190
[Epoch 87] Avg Loss: 0.0960
[Epoch 88] Avg Loss: 0.0979
[Validation] L2: 0.0158, LPIPS: 0.0192
[Epoch 89] Avg Loss: 0.1006
