Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /scratch/gz2199/calli_env/lib/python3.9/site-packages/lpips/weights/v0.1/vgg.pth
Disentangle VAE Training...
Training config: {'encoder': 'vae_encoder', 'decoder': 'vae_decoder', 'use_gan': True, 'use_ema': True, 'latent_dim': 256, 'lpips_weight': 0.8, 'kl_weight': 0.2, 'vq_loss_weight': 1.0, 'gan_weight': 0.2, 'train_stage': 'VAE', 'img_size': 128, 'train_data_root': './data/train', 'val_data_root': './data/val', 'batch_size': 32, 'epochs': 5000, 'lr': 0.0001, 'checkpoint_interval': 500, 'resume_ckpt': '', 'in_channels': 1, 'val_interval': 5000, 'train_log_interval': 100, 'lr_scheduler': 'linear-warmup_cosine-decay', 'warmup_epochs': 10, 'min_lr': 1e-05, 'kl_anneal': {'enabled': True, 'start_epoch': 0, 'end_epoch': 100}, 'gradient_clip_val': 1.0, 'lecam_weight': 0.1}
Using device: cuda
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /scratch/gz2199/calli_env/lib/python3.9/site-packages/lpips/weights/v0.1/vgg.pth
Using GAN: True, EMA: True
No checkpoint found or resume_ckpt not specified.
Found 28054 images in dataset.
[Epoch 0] Avg Loss: 0.8753
[Epoch 1] Avg Loss: 0.4131
[Epoch 2] Avg Loss: 0.2577
[Epoch 3] Avg Loss: 0.1931
[Epoch 4] Avg Loss: 0.1588
[Validation] L2: 0.0571, LPIPS: 0.1594
[Epoch 5] Avg Loss: 0.1459
[Epoch 6] Avg Loss: 0.1327
[Epoch 7] Avg Loss: 0.1235
[Epoch 8] Avg Loss: 0.1148
[Epoch 9] Avg Loss: 0.1055
[Epoch 10] Avg Loss: 0.0993
[Validation] L2: 0.0430, LPIPS: 0.1239
[Epoch 11] Avg Loss: 0.0824
[Epoch 12] Avg Loss: 0.0841
[Epoch 13] Avg Loss: 0.0833
[Epoch 14] Avg Loss: 0.0775
[Epoch 15] Avg Loss: 0.0819
[Epoch 16] Avg Loss: 0.0711
[Validation] L2: 0.0398, LPIPS: 0.1214
[Epoch 17] Avg Loss: 0.0712
[Epoch 18] Avg Loss: 0.0811
[Epoch 19] Avg Loss: 0.0743
[Epoch 20] Avg Loss: 0.0822
[Epoch 21] Avg Loss: 0.0854
[Validation] L2: 0.0426, LPIPS: 0.1200
[Epoch 22] Avg Loss: 0.0815
[Epoch 23] Avg Loss: 0.0848
[Epoch 24] Avg Loss: 0.0836
[Epoch 25] Avg Loss: 0.0909
[Epoch 26] Avg Loss: 0.0903
[Epoch 27] Avg Loss: 0.0937
[Validation] L2: 0.0446, LPIPS: 0.1257
[Epoch 28] Avg Loss: 0.0944
[Epoch 29] Avg Loss: 0.0966
[Epoch 30] Avg Loss: 0.1004
[Epoch 31] Avg Loss: 0.1027
[Epoch 32] Avg Loss: 0.1054
[Epoch 33] Avg Loss: 0.1072
[Validation] L2: 0.0481, LPIPS: 0.1331
[Epoch 34] Avg Loss: 0.1127
[Epoch 35] Avg Loss: 0.1150
[Epoch 36] Avg Loss: 0.1175
[Epoch 37] Avg Loss: 0.1213
